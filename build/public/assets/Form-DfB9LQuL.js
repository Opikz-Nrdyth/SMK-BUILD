import{b as A,a as U,u as M,c as o,j as e,L as G}from"./app-iNLJP6JY.js";import{U as f}from"./UniversalInput-DM4_R_Pm.js";import{S as T}from"./SuperAdminLayouts-Dq5rzPmY.js";import{S as K}from"./StafLayouts-Z-vGqz7f.js";import"./index-BzCDgUCn.js";import"./TextEditor-DzcaE8um.js";/* empty css                  */import"./Breadcrump-U7TSQYvC.js";function V({initialValues:s,onSubmit:x,submitLabel:B,dark:c=!1,userOptions:D,jenisPembayaranOptions:b,existingData:m,prefilledData:u}){var g;const{data:r,setData:t,processing:h,errors:w}=A(u||s||{userId:"",jenisPembayaran:"",nominalPenetapan:"",action:""}),{notify:v}=U(),{props:d}=M(),j=d==null?void 0:d.pattern.split("/").filter(a=>a!=""),I=`/${j[0]}/${j[1]}`,[P,l]=o.useState(!1),[n,y]=o.useState(null);o.useEffect(()=>{u&&t(u)},[u]);const k=async()=>{try{const i=await(await fetch(`${I}/penetapan/get?user_id=${r.userId}&jenis_pembayaran=${r.jenisPembayaran}`,{headers:{"X-Requested-With":"XMLHttpRequest"}})).json();i.success&&t("nominalPenetapan",String(i.nominal))}catch(a){console.error("Gagal mengambil nominal penetapan:",a)}};o.useEffect(()=>{r.userId&&r.jenisPembayaran&&k()},[r.userId,r.jenisPembayaran]),o.useEffect(()=>{r.userId&&r.jenisPembayaran&&!m&&R()},[r.userId,r.jenisPembayaran]);const R=async()=>{try{const a=await fetch(`${I}/check-existing?user_id=${r.userId}&jenis_pembayaran=${r.jenisPembayaran}`,{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(a.ok){const i=await a.json();console.log(i),i.success&&i.exists&&i.data?(y(i.data),l(!0)):console.log("No existing data found")}}catch(a){console.error("Error checking existing data:",a)}},F=a=>{if(a.preventDefault(),!r.userId||!r.jenisPembayaran||!r.nominalPenetapan){alert("Harap lengkapi semua field");return}if(m&&!r.action){y(m),l(!0);return}x(r)},S=a=>{a==="update"?(t("action","update"),l(!1)):(t({userId:"",jenisPembayaran:"",nominalPenetapan:"",action:""}),l(!1))},p=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),E=(b==null?void 0:b.map(a=>({label:a,value:a})))||[],N=typeof(n==null?void 0:n.nominalBayar)=="string"?JSON.parse(n==null?void 0:n.nominalBayar):n==null?void 0:n.nominalBayar;return e.jsxDEV("div",{className:"space-y-6",children:[P&&n&&e.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxDEV("div",{className:"bg-white rounded-lg shadow-lg w-[500px] max-w-[90vw] p-6",children:[e.jsxDEV("h3",{className:"text-lg font-bold text-yellow-600 mb-4",children:"⚠️ Data Sudah Ada"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:181,columnNumber:13},this),e.jsxDEV("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200 mb-4",children:[e.jsxDEV("p",{className:"text-yellow-800 mb-3",children:["Siswa ",e.jsxDEV("strong",{children:(g=n==null?void 0:n.user)==null?void 0:g.fullName},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:185,columnNumber:23},this)," sudah memiliki penetapan pembayaran untuk ",e.jsxDEV("strong",{children:n==null?void 0:n.jenisPembayaran},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:186,columnNumber:34},this),"."]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:184,columnNumber:15},this),e.jsxDEV("div",{className:"space-y-2 text-sm",children:[e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("span",{children:"Nominal Penetapan Saat Ini:"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:191,columnNumber:19},this),e.jsxDEV("strong",{children:p(parseFloat((n==null?void 0:n.nominalPenetapan)||"0"))},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:192,columnNumber:19},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:190,columnNumber:17},this),e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("span",{children:"Total Sudah Dibayar:"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:197,columnNumber:19},this),e.jsxDEV("strong",{children:p(N?N==null?void 0:N.reduce((a,i)=>a+parseFloat(i.nominal||"0"),0):0)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:198,columnNumber:19},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:196,columnNumber:17},this),e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("span",{children:"Nominal Baru:"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:210,columnNumber:19},this),e.jsxDEV("strong",{children:p(parseFloat(r.nominalPenetapan||"0"))},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:211,columnNumber:19},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:209,columnNumber:17},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:189,columnNumber:15},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:183,columnNumber:13},this),e.jsxDEV("p",{className:"text-gray-600 mb-4",children:"Apa yang ingin Anda lakukan?"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:216,columnNumber:13},this),e.jsxDEV("div",{className:"flex justify-end space-x-3",children:[e.jsxDEV("button",{onClick:()=>S("cancel"),className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors",children:"Batal & Reset Form"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:219,columnNumber:15},this),e.jsxDEV("button",{onClick:()=>S("update"),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Update Penetapan"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:225,columnNumber:15},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:218,columnNumber:13},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:180,columnNumber:11},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:179,columnNumber:9},this),e.jsxDEV("form",{onSubmit:F,className:"space-y-6",children:[e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxDEV(f,{type:"select",name:"userId",label:"Siswa",value:r.userId,onChange:a=>t("userId",a),options:D||[],required:!0,dark:c},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:238,columnNumber:11},this),e.jsxDEV(f,{type:"select",name:"jenisPembayaran",label:"Jenis Pembayaran",value:r.jenisPembayaran,onChange:a=>t("jenisPembayaran",a),options:E,required:!0,dark:c},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:249,columnNumber:11},this),e.jsxDEV("div",{className:"md:col-span-2",children:e.jsxDEV(f,{type:"currency",name:"nominalPenetapan",label:"Nominal Penetapan",disabled:!0,value:r.nominalPenetapan,onChange:a=>v("Anda tidak bisa membuat penetapan pembayaran manual","error"),required:!0,dark:c},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:261,columnNumber:13},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:260,columnNumber:11},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:237,columnNumber:9},this),m&&!P&&e.jsxDEV("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{children:e.jsxDEV("p",{className:"text-blue-800",children:[e.jsxDEV("strong",{children:"Info:"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:282,columnNumber:19},this)," Data untuk siswa ini sudah ada. Silakan submit form untuk mengupdate penetapan."]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:281,columnNumber:17},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:280,columnNumber:15},this),e.jsxDEV("button",{type:"button",onClick:()=>l(!0),className:"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Lihat Detail"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:286,columnNumber:15},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:279,columnNumber:13},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:278,columnNumber:11},this),e.jsxDEV("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsxDEV(G,{href:I,className:"px-6 py-3 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors",children:"Batal"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:298,columnNumber:11},this),e.jsxDEV("button",{type:"submit",disabled:h,className:"px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 flex items-center space-x-2 transition-colors",children:h?e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:311,columnNumber:17},this),e.jsxDEV("span",{children:"Menyimpan..."},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:312,columnNumber:17},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:310,columnNumber:15},this):e.jsxDEV("span",{children:m?"Update Penetapan":B},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:315,columnNumber:15},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:304,columnNumber:11},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:297,columnNumber:9},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:236,columnNumber:7},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:176,columnNumber:5},this)}V.layout=s=>(s.props.activeRole??s.props.user.role)=="Staf"?e.jsxDEV(K,{children:s},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:327,columnNumber:12},void 0):e.jsxDEV(T,{children:s},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:330,columnNumber:10},void 0);export{V as default};
