import{b as F,u as R,c as u,j as e,L as E}from"./app-Bzs2Gd0p.js";import{U as I}from"./UniversalInput-gcmVdzHR.js";import{S as A}from"./SuperAdminLayouts-B2SIYU2P.js";import{S as U}from"./StafLayouts-DaalXZaH.js";import"./index-BzCDgUCn.js";import"./TextEditor-CezWaANt.js";/* empty css                  */import"./Breadcrump-CXoRlEgY.js";function M({initialValues:n,onSubmit:p,submitLabel:g,dark:N=!1,userOptions:D,jenisPembayaranOptions:c,existingData:m,prefilledData:l}){var y;const{data:r,setData:i,processing:f,errors:T}=F(l||n||{userId:"",jenisPembayaran:"",nominalPenetapan:"",action:""}),{props:b}=R(),x=b==null?void 0:b.pattern.split("/").filter(a=>a!=""),h=`/${x[0]}/${x[1]}`,[P,o]=u.useState(!1),[t,j]=u.useState(null);u.useEffect(()=>{l&&i(l)},[l]),u.useEffect(()=>{r.userId&&r.jenisPembayaran&&!m&&B()},[r.userId,r.jenisPembayaran]);const B=async()=>{try{const a=await fetch(`${h}/check-existing?user_id=${r.userId}&jenis_pembayaran=${r.jenisPembayaran}`,{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(a.ok){const s=await a.json();s.success&&s.exists&&s.data?(j(s.data),o(!0)):console.log("No existing data found")}}catch(a){console.error("Error checking existing data:",a)}},v=a=>{if(a.preventDefault(),!r.userId||!r.jenisPembayaran||!r.nominalPenetapan){alert("Harap lengkapi semua field");return}if(m&&!r.action){j(m),o(!0);return}p(r)},S=a=>{a==="update"?(i("action","update"),o(!1)):(i({userId:"",jenisPembayaran:"",nominalPenetapan:"",action:""}),o(!1))},d=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),k=(c==null?void 0:c.map(a=>({label:a,value:a})))||[];return e.jsxDEV("div",{className:"space-y-6",children:[P&&t&&e.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxDEV("div",{className:"bg-white rounded-lg shadow-lg w-[500px] max-w-[90vw] p-6",children:[e.jsxDEV("h3",{className:"text-lg font-bold text-yellow-600 mb-4",children:"⚠️ Data Sudah Ada"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:147,columnNumber:13},this),e.jsxDEV("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200 mb-4",children:[e.jsxDEV("p",{className:"text-yellow-800 mb-3",children:["Siswa ",e.jsxDEV("strong",{children:(y=t.user)==null?void 0:y.fullName},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:151,columnNumber:23},this)," sudah memiliki penetapan pembayaran untuk ",e.jsxDEV("strong",{children:t.jenisPembayaran},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:152,columnNumber:34},this),"."]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:150,columnNumber:15},this),e.jsxDEV("div",{className:"space-y-2 text-sm",children:[e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("span",{children:"Nominal Penetapan Saat Ini:"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:157,columnNumber:19},this),e.jsxDEV("strong",{children:d(parseFloat(t.nominalPenetapan||"0"))},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:158,columnNumber:19},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:156,columnNumber:17},this),e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("span",{children:"Total Sudah Dibayar:"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:163,columnNumber:19},this),e.jsxDEV("strong",{children:d(t.nominalBayar?t.nominalBayar.reduce((a,s)=>a+parseFloat(s.nominal||"0"),0):0)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:164,columnNumber:19},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:162,columnNumber:17},this),e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("span",{children:"Nominal Baru:"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:176,columnNumber:19},this),e.jsxDEV("strong",{children:d(parseFloat(r.nominalPenetapan||"0"))},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:177,columnNumber:19},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:175,columnNumber:17},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:155,columnNumber:15},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:149,columnNumber:13},this),e.jsxDEV("p",{className:"text-gray-600 mb-4",children:"Apa yang ingin Anda lakukan?"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:182,columnNumber:13},this),e.jsxDEV("div",{className:"flex justify-end space-x-3",children:[e.jsxDEV("button",{onClick:()=>S("cancel"),className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors",children:"Batal & Reset Form"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:185,columnNumber:15},this),e.jsxDEV("button",{onClick:()=>S("update"),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Update Penetapan"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:191,columnNumber:15},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:184,columnNumber:13},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:146,columnNumber:11},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:145,columnNumber:9},this),e.jsxDEV("form",{onSubmit:v,className:"space-y-6",children:[e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxDEV(I,{type:"select",name:"userId",label:"Siswa",value:r.userId,onChange:a=>i("userId",a),options:D||[],required:!0,dark:N},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:204,columnNumber:11},this),e.jsxDEV(I,{type:"select",name:"jenisPembayaran",label:"Jenis Pembayaran",value:r.jenisPembayaran,onChange:a=>i("jenisPembayaran",a),options:k,required:!0,dark:N},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:215,columnNumber:11},this),e.jsxDEV("div",{className:"md:col-span-2",children:e.jsxDEV(I,{type:"currency",name:"nominalPenetapan",label:"Nominal Penetapan",value:r.nominalPenetapan,onChange:a=>i("nominalPenetapan",a),required:!0,dark:N},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:227,columnNumber:13},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:226,columnNumber:11},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:203,columnNumber:9},this),m&&!P&&e.jsxDEV("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{children:e.jsxDEV("p",{className:"text-blue-800",children:[e.jsxDEV("strong",{children:"Info:"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:245,columnNumber:19},this)," Data untuk siswa ini sudah ada. Silakan submit form untuk mengupdate penetapan."]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:244,columnNumber:17},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:243,columnNumber:15},this),e.jsxDEV("button",{type:"button",onClick:()=>o(!0),className:"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Lihat Detail"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:249,columnNumber:15},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:242,columnNumber:13},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:241,columnNumber:11},this),e.jsxDEV("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsxDEV(E,{href:h,className:"px-6 py-3 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors",children:"Batal"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:261,columnNumber:11},this),e.jsxDEV("button",{type:"submit",disabled:f,className:"px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 flex items-center space-x-2 transition-colors",children:f?e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:274,columnNumber:17},this),e.jsxDEV("span",{children:"Menyimpan..."},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:275,columnNumber:17},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:273,columnNumber:15},this):e.jsxDEV("span",{children:m?"Update Penetapan":g},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:278,columnNumber:15},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:267,columnNumber:11},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:260,columnNumber:9},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:202,columnNumber:7},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:142,columnNumber:5},this)}M.layout=n=>(n.props.activeRole??n.props.user.role)=="Staf"?e.jsxDEV(U,{children:n},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:290,columnNumber:12},void 0):e.jsxDEV(A,{children:n},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Form.tsx",lineNumber:293,columnNumber:10},void 0);export{M as default};
