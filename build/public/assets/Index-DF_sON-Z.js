import{c as l,j as a,u as K,L as T,r as x}from"./app-D-AlCsI9.js";import{N as C}from"./Notification-DkVvHERy.js";import{D as E}from"./TabelData-DK3QOFq1.js";import{M as W}from"./ModalView-DuQ8G--3.js";import{S as L}from"./SuperAdminLayouts-DDh0Gaam.js";import{G as F}from"./GuruLayouts-D90zMq1r.js";import{S as J}from"./StafLayouts-DNWQaC5q.js";import"./FormatWaktu-CaIpskCQ.js";import"./Breadcrump-CQG3d_M-.js";function z({row:u,onClose:m,onSend:s}){const[r,b]=l.useState("Hallo {siswa}, Anda masih punya tunggakan {jenisPembayaran} senilai {sisaPembayaran}"),o=[{label:"Nama Siswa",key:"{siswa}"},{label:"Jenis Pembayaran",key:"{jenisPembayaran}"},{label:"Sisa Pembayaran",key:"{sisaPembayaran}"}],P=t=>{const i=document.getElementById("messageBox");if(!i)return;const c=i.selectionStart,d=i.selectionEnd,S=r.substring(0,c)+t+r.substring(d);b(S),setTimeout(()=>{i.focus(),i.selectionStart=i.selectionEnd=c+t.length},0)},g=t=>{const i=document.getElementById("messageBox");if(!i)return;const c=i.selectionStart,d=i.selectionEnd,S=r.substring(c,d),p=r.substring(0,c)+t+S+t+r.substring(d);b(p)},f=()=>{const t=r.replace("{siswa}",u.siswa).replace("{jenisPembayaran}",u.jenisPembayaran).replace("{sisaPembayaran}",u.sisaPembayaran);localStorage.setItem("messagePesan",r),s(t)};return l.useEffect(()=>{localStorage.messagePesan&&b(localStorage.messagePesan)},[]),a.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxDEV("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-5 w-full max-w-lg shadow-lg",children:[a.jsxDEV("h2",{className:"text-lg font-semibold mb-3 text-gray-800 dark:text-gray-100",children:"Buat Pesan WhatsApp"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:62,columnNumber:9},this),a.jsxDEV("div",{className:"flex flex-wrap gap-2 mb-3",children:[a.jsxDEV("button",{onClick:()=>g("*"),className:"px-3 py-1 border rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:a.jsxDEV("b",{children:"B"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:72,columnNumber:13},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:68,columnNumber:11},this),a.jsxDEV("button",{onClick:()=>g("_"),className:"px-3 py-1 border rounded hover:bg-gray-100 dark:hover:bg-gray-700 italic",children:"I"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:74,columnNumber:11},this),a.jsxDEV("button",{onClick:()=>g("~"),className:"px-3 py-1 border rounded hover:bg-gray-100 dark:hover:bg-gray-700 line-through",children:"S"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:80,columnNumber:11},this),o.map(t=>a.jsxDEV("button",{onClick:()=>P(t.key),className:"px-3 py-1 border rounded text-sm bg-blue-50 dark:bg-blue-900 dark:text-blue-200 hover:bg-blue-100",children:t.label},t.key,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:89,columnNumber:13},this))]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:67,columnNumber:9},this),a.jsxDEV("textarea",{id:"messageBox",value:r,onChange:t=>b(t.target.value),rows:6,className:"w-full border rounded-lg p-3 text-sm dark:bg-gray-900 dark:text-gray-100",placeholder:"Tulis pesan di sini..."},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:100,columnNumber:9},this),a.jsxDEV("div",{className:"flex justify-end mt-4 gap-3",children:[a.jsxDEV("button",{onClick:m,className:"px-4 py-2 rounded-lg border hover:bg-gray-100 dark:hover:bg-gray-700",children:"Batal"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:111,columnNumber:11},this),a.jsxDEV("button",{onClick:f,className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Kirim"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:117,columnNumber:11},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:110,columnNumber:9},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:61,columnNumber:7},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/Components/WhatsappMessagePopup.tsx",lineNumber:60,columnNumber:5},this)}function $({auth:u,pembayarans:m,pembayaranPaginate:s,filter:r,searchQuery:b=""}){const{props:o}=K(),[P,g]=l.useState([]),[f,t]=l.useState(),[i,c]=l.useState((s==null?void 0:s.currentPage)||1),[d,S]=l.useState((s==null?void 0:s.lastPage)||1),[p,j]=l.useState(b),[y,w]=l.useState(null),[R,D]=l.useState(!1),[h,B]=l.useState({search:(r==null?void 0:r.search)||"",jenisPembayaran:(r==null?void 0:r.jenisPembayaran)||"",tanggal:(r==null?void 0:r.tanggal)||""});l.useEffect(()=>{if(!m)return;const e=[];m==null||m.forEach(n=>{e.push({id:n.id,siswa:n.userName,jenisPembayaran:n.jenisPembayaran,nominalPenetapan:N(n.nominalPenetapan),totalDibayar:N(n.totalDibayar),sisaPembayaran:N(n.sisaPembayaran),status:n.lunas?"Lunas":"Belum Lunas",createdAt:n.createdAt,noTelepon:n.user.dataSiswa.noTelepon,detailData:{id:n.id,siswa:n.userName,jenisPembayaran:n.jenisPembayaran,nominalPenetapan:N(n.nominalPenetapan),totalDibayar:N(n.totalDibayar),sisaPembayaran:N(n.sisaPembayaran),status:n.lunas?"Lunas":"Belum Lunas",tanggalDibuat:n.createdAt,riwayatPembayaran:n.riwayatPembayaran||[]}})}),g(e)},[m]);const N=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e),k=e=>{x.get(String(o.pattern),{page:e,...h,search:p},{preserveState:!0,replace:!0}),c(e)},v=e=>{j(e),x.get(String(o.pattern),{page:1,...h,search:e},{preserveState:!0,replace:!0,preserveScroll:!0}),c(1)},M=(e,n)=>{const I={...h,[e]:n};B(I),setTimeout(()=>{x.get(String(o.pattern),{...I,search:p},{preserveState:!0,replace:!0})},500)},A=["SPP","Uang Daftar Ulang","Uang Pangkal"],G=e=>{if(!(e!=null&&e.detailData))return{};const n={informasiPembayaran:{siswa:e.detailData.siswa,jenisPembayaran:e.detailData.jenisPembayaran,nominalPenetapan:e.detailData.nominalPenetapan,totalDibayar:e.detailData.totalDibayar,sisaPembayaran:e.detailData.sisaPembayaran,status:e.detailData.status,tanggalDibuat:e.detailData.tanggalDibuat}};return e.detailData.riwayatPembayaran&&e.detailData.riwayatPembayaran.length>0&&(n.riwayatPembayaran=e.detailData.riwayatPembayaran.map((I,V)=>({tanggal:I.tanggal,nominal:N(parseFloat(I.nominal)),urutan:V+1}))),n},U=e=>{const n={number:y==null?void 0:y.noTelepon,message:e};x.post("/api/whatsapp/send-message",n)};return a.jsxDEV("div",{className:"max-w-7xl mx-auto lg:p-6",children:[a.jsxDEV(C,{},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:166,columnNumber:7},this),R&&a.jsxDEV(z,{row:y,onClose:()=>D(!1),onSend:e=>{D(!1),U(e)}},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:169,columnNumber:9},this),a.jsxDEV("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6",children:[a.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Data Pembayaran"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:179,columnNumber:9},this),o.user.role!="Guru"&&a.jsxDEV("div",{className:"flex flex-wrap items-center lg::gap-3 gap-1",children:[a.jsxDEV(T,{href:`${o.pattern}/create`,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors duration-200",children:"Tambah Pembayaran"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:182,columnNumber:13},this),a.jsxDEV("button",{onClick:()=>{x.post("/api/whatsapp/initialize")},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200",children:"Initiasi Whatsapp"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:188,columnNumber:13},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:181,columnNumber:11},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:178,columnNumber:7},this),a.jsxDEV("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-6 border border-purple-200 dark:border-purple-800",children:a.jsxDEV("div",{className:"flex justify-between items-center",children:[a.jsxDEV("div",{className:"flex flex-wrap gap-4 items-center",children:[a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-100 mb-2",children:"Jenis Pembayaran"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:205,columnNumber:15},this),a.jsxDEV("select",{value:h.jenisPembayaran,onChange:e=>M("jenisPembayaran",e.target.value),className:"block w-full pl-3 pr-10 py-2 border text-base dark:text-gray-50 border-purple-300 dark:bg-gray-700 dark:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md transition-colors duration-200",children:[a.jsxDEV("option",{value:"",children:"Semua Jenis"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:213,columnNumber:17},this),A.map(e=>a.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:215,columnNumber:19},this))]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:208,columnNumber:15},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:204,columnNumber:13},this),a.jsxDEV("div",{children:[a.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-100 mb-2",children:"Tanggal Pembayaran"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:222,columnNumber:15},this),a.jsxDEV("input",{type:"date",value:h.tanggal,onChange:e=>M("tanggal",e.target.value),className:"block w-full pl-3 border pr-10 py-2 text-base dark:text-gray-50 border-purple-300 dark:bg-gray-700 dark:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md transition-colors duration-200"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:225,columnNumber:15},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:221,columnNumber:13},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:203,columnNumber:11},this),a.jsxDEV("div",{className:"flex items-end",children:a.jsxDEV("button",{onClick:()=>{B({search:"",jenisPembayaran:"",tanggal:""}),j(""),x.get(String(o.pattern),{},{preserveState:!0})},className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors duration-200",children:"Reset Filter"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:234,columnNumber:13},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:233,columnNumber:11},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:202,columnNumber:9},this)},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:201,columnNumber:7},this),o.user.role=="Guru"?a.jsxDEV(E,{data:P,tabelName:"Pembayaran",columns:[{header:"Siswa",accessor:"siswa"},{header:"Jenis Pembayaran",accessor:"jenisPembayaran"},{header:"Nominal Penetapan",accessor:"nominalPenetapan"},{header:"Total Dibayar",accessor:"totalDibayar"},{header:"Sisa Pembayaran",accessor:"sisaPembayaran"},{header:"Status",accessor:"status"}],pageSize:15,placeholder:"Cari pembayaran berdasarkan nama siswa...",noDataText:"Tidak ada data pembayaran",onRowClick:e=>t(e),serverPagination:{currentPage:i,lastPage:d,total:(s==null?void 0:s.total)||0,onPageChange:k},serverSearch:{value:p,onChange:v}},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:249,columnNumber:9},this):a.jsxDEV(E,{data:P,tabelName:"Pembayaran",columns:[{header:"Siswa",accessor:"siswa"},{header:"Jenis Pembayaran",accessor:"jenisPembayaran"},{header:"Nominal Penetapan",accessor:"nominalPenetapan"},{header:"Total Dibayar",accessor:"totalDibayar"},{header:"Sisa Pembayaran",accessor:"sisaPembayaran"},{header:"Status",accessor:"status"},{header:"Cetak",accessor:"id",action:e=>a.jsxDEV(a.Fragment,{children:[a.jsxDEV(T,{href:`${o.pattern}/${e.id}/cetak`,className:"text-purple-600 hover:text-purple-800 px-2 py-1 rounded-md flex items-center gap-1 transition-colors duration-200",children:[a.jsxDEV("i",{className:"fas fa-print"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:301,columnNumber:21},this),"Cetak"]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:297,columnNumber:19},this),e.status=="Belum Lunas"&&a.jsxDEV("button",{onClick:()=>{w(e),D(!0)},className:"text-green-600 hover:text-green-800 px-2 py-1 rounded-md flex items-center gap-1 transition-colors duration-200",children:[a.jsxDEV("i",{className:"fa-brands fa-whatsapp"},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:312,columnNumber:23},this)," Whatsapp"]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:305,columnNumber:21},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:296,columnNumber:17},this)}],editable:String(o.pattern),pageSize:15,placeholder:"Cari pembayaran berdasarkan nama siswa...",noDataText:"Tidak ada data pembayaran",onRowClick:e=>t(e),serverPagination:{currentPage:i,lastPage:d,total:(s==null?void 0:s.total)||0,onPageChange:k},serverSearch:{value:p,onChange:v}},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:279,columnNumber:9},this),a.jsxDEV(W,{data:G(f),open:!!f,onClose:()=>t(null),title:"Detail Pembayaran",exclude:[]},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:337,columnNumber:7},this)]},void 0,!0,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:165,columnNumber:5},this)}$.layout=u=>{const m=u.props.activeRole??u.props.user.role;return m=="Guru"?a.jsxDEV(F,{children:u},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:351,columnNumber:12},void 0):m=="Staf"?a.jsxDEV(J,{children:u},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:355,columnNumber:12},void 0):a.jsxDEV(L,{children:u},void 0,!1,{fileName:"G:/Bank Project/2026/SMK-BINA-INDUSTRI/inertia/pages/Pembayaran/Index.tsx",lineNumber:358,columnNumber:10},void 0)};export{$ as default};
